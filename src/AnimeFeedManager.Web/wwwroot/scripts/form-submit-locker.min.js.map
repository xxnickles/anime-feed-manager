{"version":3,"sources":["wwwroot/scripts/form-submit-locker.js"],"sourcesContent":["(() => {\r\n    // Utility function: debounce (delays execution until after wait ms of inactivity)\r\n    function debounce(func, wait) {\r\n        let timeout;\r\n        return function(...args) {\r\n            const context = this;\r\n            clearTimeout(timeout);\r\n            timeout = setTimeout(() => func.apply(context, args), wait);\r\n        };\r\n    }\r\n\r\n    // Utility function: throttle (ensures function is called at most once per wait ms)\r\n    function throttle(func, wait) {\r\n        let timeout;\r\n        let lastTime = 0;\r\n        return function(...args) {\r\n            const context = this;\r\n            const now = Date.now();\r\n            const remaining = wait - (now - lastTime);\r\n\r\n            if (remaining <= 0) {\r\n                clearTimeout(timeout);\r\n                lastTime = now;\r\n                func.apply(context, args);\r\n            } else if (!timeout) {\r\n                timeout = setTimeout(() => {\r\n                    lastTime = Date.now();\r\n                    func.apply(context, args);\r\n                }, remaining);\r\n            }\r\n        };\r\n    }\r\n\r\n    const pluginName = \"form-submit-locker\";\r\n\r\n    /**\r\n     * Alpine.js plugin: x-form-submit-locker\r\n     *\r\n     * Core functionality:\r\n     * - Disables the submit button when the form is invalid based on HTML5 constraints\r\n     * - Prevents browser-native validation popups by setting novalidate\r\n     * - Updates button state on input, select, form reset, and browser navigation\r\n     * - Warns and opts-out if multiple submit buttons are detected\r\n     * - Configurable debounce delay via modifiers\r\n     *\r\n     * Relies on browser's built-in :valid/:invalid pseudo-classes for styling\r\n     */\r\n    function plugin_default(Alpine) {\r\n        const FORM_TAG = \"FORM\";\r\n        const DEFAULT_DEBOUNCE_DELAY = 300;\r\n\r\n        Alpine.directive(pluginName, (el, { modifiers, expression }, { cleanup, evaluate }) => {\r\n            // Ensure the directive is only applied to <form> elements\r\n            if (el.tagName !== FORM_TAG) {\r\n                console.error(`[x-${pluginName}] Directive must be used on <form> elements only.`);\r\n                return;\r\n            }\r\n\r\n            // Parse configuration from modifiers or expression\r\n            const config = {\r\n                debounceDelay: parseInt(modifiers[0]) || DEFAULT_DEBOUNCE_DELAY,\r\n                validateOnMount: !modifiers.includes('no-initial-validation'),\r\n                disableOnSubmit: modifiers.includes('disable-on-submit'),\r\n                allowMultipleSubmits: modifiers.includes('allow-multiple-submits'),\r\n                focusOnError: !modifiers.includes('no-focus-on-error'),\r\n                changeTextOnSubmit: modifiers.includes('change-text'),\r\n                customValidator: expression ? () => evaluate(expression) : null\r\n            };\r\n\r\n            // Find all submit buttons within the form\r\n            const submitButtons = Array.from(el.querySelectorAll('button[type=\"submit\"], input[type=\"submit\"], button:not([type])')).filter(btn => {\r\n                // Filter out buttons that are explicitly not submit buttons\r\n                const type = btn.getAttribute('type');\r\n                return type === 'submit' || (btn.tagName === 'BUTTON' && !type);\r\n            });\r\n\r\n            // Check for multiple submit buttons and warn/opt-out\r\n            if (submitButtons.length > 1 && !config.allowMultipleSubmits) {\r\n                console.warn(\r\n                    `[x-${pluginName}] Multiple submit buttons detected in form. This often indicates a UX issue that could be better solved with:\\n` +\r\n                    `- Separate forms for different actions\\n` +\r\n                    `- A single submit with radio/select for action type\\n` +\r\n                    `- JavaScript-driven workflow buttons\\n\\n` +\r\n                    `The form submit locker has been disabled for this form.\\n` +\r\n                    `If you really need multiple submit buttons, add the 'allow-multiple-submits' modifier:\\n` +\r\n                    `<form x-${pluginName}.allow-multiple-submits>\\n\\n` +\r\n                    `Form element:`, el\r\n                );\r\n                return; // Opt-out of applying the plugin\r\n            }\r\n\r\n            if (submitButtons.length === 0) {\r\n                console.warn(`[x-${pluginName}] No submit buttons found in form.`);\r\n                return;\r\n            }\r\n\r\n            // Get the single submit button\r\n            const submitButton = submitButtons[0];\r\n\r\n            // Store original disabled state to restore it properly\r\n            const originalDisabledState = submitButton.disabled;\r\n\r\n            // Disable browser-based validation UI (popups) for this form\r\n            el.setAttribute(\"novalidate\", true);\r\n\r\n            /**\r\n             * Evaluates the form's validity\r\n             * @returns {boolean} True if form is valid\r\n             */\r\n            function isFormValid() {\r\n                // Check HTML5 constraint validation\r\n                let isValid = el.checkValidity();\r\n\r\n                // Apply custom validator if provided\r\n                if (config.customValidator) {\r\n                    try {\r\n                        const customResult = config.customValidator();\r\n                        isValid = isValid && customResult;\r\n                    } catch (e) {\r\n                        console.error(`[x-${pluginName}] Custom validator error:`, e);\r\n                    }\r\n                }\r\n\r\n                return isValid;\r\n            }\r\n\r\n            /**\r\n             * Evaluates the form's validity and toggles the disabled state of submit button\r\n             */\r\n            function evaluateSubmit() {\r\n                const isValid = isFormValid();\r\n\r\n                Alpine.nextTick(() => {\r\n                    // Only modify disabled state if it wasn't originally disabled\r\n                    if (!originalDisabledState) {\r\n                        submitButton.disabled = !isValid;\r\n\r\n                        // Set aria-disabled for better accessibility\r\n                        if (isValid) {\r\n                            submitButton.removeAttribute('aria-disabled');\r\n                        } else {\r\n                            submitButton.setAttribute('aria-disabled', 'true');\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n\r\n            // Debounced handler for text input events\r\n            const inputHandler = debounce((event) => {\r\n                if (['INPUT', 'TEXTAREA'].includes(event.target.tagName)) {\r\n                    evaluateSubmit();\r\n                }\r\n            }, config.debounceDelay);\r\n\r\n            // Immediate handler for select changes\r\n            const changeHandler = (event) => {\r\n                if (event.target.tagName === 'SELECT') {\r\n                    evaluateSubmit();\r\n                }\r\n            };\r\n\r\n            // Handler for form reset\r\n            const resetHandler = (event) => {\r\n                if (event.target === el) {\r\n                    // Re-evaluate after a tick to allow form to reset\r\n                    setTimeout(() => evaluateSubmit(), 0);\r\n                }\r\n            };\r\n\r\n            // Track submission state\r\n            let isSubmitting = false;\r\n\r\n            /**\r\n             * Resets the submit button to its normal state after submission\r\n             */\r\n            function resetSubmitButton() {\r\n                if (!isSubmitting) return;\r\n\r\n                isSubmitting = false;\r\n                submitButton.removeAttribute('aria-busy');\r\n\r\n                // Restore original text if it was changed\r\n                if (config.changeTextOnSubmit && submitButton.dataset.originalText) {\r\n                    submitButton.textContent = submitButton.dataset.originalText;\r\n                    delete submitButton.dataset.originalText;\r\n                }\r\n\r\n                // Re-evaluate form validity for button states\r\n                evaluateSubmit();\r\n            }\r\n\r\n            // Handler for form submission\r\n            const submitHandler = (event) => {\r\n                const isValid = isFormValid();\r\n\r\n                if (!isValid) {\r\n                    event.preventDefault();\r\n                    event.stopPropagation();\r\n\r\n                    // Focus first invalid field if configured\r\n                    if (config.focusOnError) {\r\n                        // Use the browser's built-in :invalid selector\r\n                        const firstInvalid = el.querySelector(':invalid:not([type=\"hidden\"]):not([disabled])');\r\n                        if (firstInvalid) {\r\n                            firstInvalid.focus();\r\n                            firstInvalid.scrollIntoView({ behavior: 'smooth', block: 'center' });\r\n                        }\r\n                    }\r\n\r\n                    // Announce to screen readers\r\n                    const announcement = document.createElement('div');\r\n                    announcement.setAttribute('role', 'alert');\r\n                    announcement.setAttribute('aria-live', 'polite');\r\n                    announcement.style.position = 'absolute';\r\n                    announcement.style.left = '-10000px';\r\n                    announcement.style.width = '1px';\r\n                    announcement.style.height = '1px';\r\n                    announcement.style.overflow = 'hidden';\r\n                    announcement.textContent = 'Form validation failed. Please check the required fields.';\r\n                    el.appendChild(announcement);\r\n                    setTimeout(() => announcement.remove(), 1000);\r\n                } else if (config.disableOnSubmit) {\r\n                    // For non-HTMX forms, disable immediately\r\n                    // For HTMX forms, we'll handle this in htmx:beforeRequest\r\n                    const hasHtmxAttributes = el.hasAttribute('hx-post') ||\r\n                        el.hasAttribute('hx-put') ||\r\n                        el.hasAttribute('hx-patch') ||\r\n                        el.hasAttribute('hx-delete') ||\r\n                        el.hasAttribute('hx-get');\r\n\r\n                    if (!hasHtmxAttributes) {\r\n                        isSubmitting = true;\r\n\r\n                        // Disable submit button during submission\r\n                        submitButton.disabled = true;\r\n                        submitButton.setAttribute('aria-busy', 'true');\r\n\r\n                        // Only change text if explicitly configured\r\n                        if (config.changeTextOnSubmit && submitButton.tagName === 'BUTTON' && !submitButton.dataset.originalText) {\r\n                            submitButton.dataset.originalText = submitButton.textContent;\r\n                            submitButton.textContent = submitButton.dataset.loadingText || 'Submitting...';\r\n                        }\r\n                    }\r\n                    // For HTMX forms, don't disable here - wait for confirmation\r\n                }\r\n            };\r\n\r\n            // HTMX-specific handlers\r\n            const htmxConfirmHandler = (event) => {\r\n                // Check if this is our form or a child element\r\n                if (event.detail.elt === el || el.contains(event.detail.elt)) {\r\n                    // Just track that a confirmation was triggered\r\n                    // We'll monitor if a request follows or not\r\n\r\n                    // Add a listener for the issueRequest callback if it exists\r\n                    const originalIssueRequest = event.detail.issueRequest;\r\n                    if (typeof originalIssueRequest === 'function') {\r\n                        event.detail.issueRequest = function(proceed) {\r\n                            // Call the original\r\n                            originalIssueRequest(proceed);\r\n\r\n                            // If user cancelled, reset button state\r\n                            if (!proceed && submitButton.disabled && !originalDisabledState) {\r\n                                resetSubmitButton();\r\n                            }\r\n                        };\r\n                    }\r\n                }\r\n            };\r\n\r\n            const htmxBeforeRequestHandler = (event) => {\r\n                if (event.detail.elt === el || el.contains(event.detail.elt)) {\r\n                    // Only disable if not already submitting (avoids double-disable)\r\n                    if (config.disableOnSubmit && !isSubmitting) {\r\n                        isSubmitting = true;\r\n                        submitButton.disabled = true;\r\n                        submitButton.setAttribute('aria-busy', 'true');\r\n\r\n                        // Only change text if explicitly configured\r\n                        if (config.changeTextOnSubmit && submitButton.tagName === 'BUTTON' && !submitButton.dataset.originalText) {\r\n                            submitButton.dataset.originalText = submitButton.textContent;\r\n                            submitButton.textContent = submitButton.dataset.loadingText || 'Submitting...';\r\n                        }\r\n                    }\r\n                }\r\n            };\r\n\r\n            const htmxAfterRequestHandler = (event) => {\r\n                if (event.detail.elt === el || el.contains(event.detail.elt)) {\r\n                    resetSubmitButton();\r\n                }\r\n            };\r\n\r\n            // Handler for when form submission is cancelled (including by confirmation)\r\n            const htmxHaltedHandler = (event) => {\r\n                if (event.detail.elt === el || el.contains(event.detail.elt)) {\r\n                    // Request was halted, reset button if it was disabled\r\n                    if (isSubmitting) {\r\n                        resetSubmitButton();\r\n                    }\r\n                }\r\n            };\r\n\r\n            // Listen for HTMX events if HTMX is present\r\n            if (window.htmx || document.querySelector('[hx-boost], [hx-get], [hx-post], [hx-put], [hx-patch], [hx-delete]')) {\r\n                // IMPORTANT: htmx:confirm must be registered BEFORE htmx:beforeRequest\r\n                document.body.addEventListener('htmx:confirm', htmxConfirmHandler);\r\n                document.body.addEventListener('htmx:beforeRequest', htmxBeforeRequestHandler);\r\n                document.body.addEventListener('htmx:afterRequest', htmxAfterRequestHandler);\r\n                // Also listen for response errors\r\n                document.body.addEventListener('htmx:responseError', htmxAfterRequestHandler);\r\n                document.body.addEventListener('htmx:sendError', htmxAfterRequestHandler);\r\n                // Listen for halted events (includes cancelled confirmations)\r\n                document.body.addEventListener('htmx:halted', htmxHaltedHandler);\r\n            }\r\n\r\n            // Handler for browser navigation (back/forward)\r\n            const popStateHandler = throttle(() => {\r\n                // Re-evaluate form state after navigation\r\n                setTimeout(() => evaluateSubmit(), 100);\r\n            }, 500);\r\n\r\n            // Attach event listeners\r\n            el.addEventListener('input', inputHandler, true);\r\n            el.addEventListener('change', changeHandler, true);\r\n            el.addEventListener('reset', resetHandler, true);\r\n            el.addEventListener('submit', submitHandler, true);\r\n            window.addEventListener('popstate', popStateHandler);\r\n\r\n            // Initial evaluation\r\n            if (config.validateOnMount) {\r\n                // Delay initial validation to ensure Alpine is fully initialized\r\n                Alpine.nextTick(() => evaluateSubmit());\r\n            }\r\n\r\n            // Alpine event handlers for AJAX submissions\r\n            const alpineSubmitSuccessHandler = () => {\r\n                resetSubmitButton();\r\n            };\r\n\r\n            const alpineSubmitErrorHandler = () => {\r\n                resetSubmitButton();\r\n            };\r\n\r\n            // Listen for Alpine/custom events that might indicate AJAX submission\r\n            el.addEventListener('ajax:success', alpineSubmitSuccessHandler);\r\n            el.addEventListener('ajax:error', alpineSubmitErrorHandler);\r\n            el.addEventListener('submit:success', alpineSubmitSuccessHandler);\r\n            el.addEventListener('submit:error', alpineSubmitErrorHandler);\r\n\r\n            // Expose API for programmatic control\r\n            el._formSubmitLocker = {\r\n                validate: () => isFormValid(),\r\n                evaluateSubmit: () => evaluateSubmit(),\r\n                reset: () => {\r\n                    el.reset();\r\n                    evaluateSubmit();\r\n                },\r\n                // Manual unlock for custom AJAX implementations\r\n                unlock: () => resetSubmitButton()\r\n            };\r\n\r\n            // Cleanup function\r\n            cleanup(() => {\r\n                el.removeEventListener('input', inputHandler, true);\r\n                el.removeEventListener('change', changeHandler, true);\r\n                el.removeEventListener('reset', resetHandler, true);\r\n                el.removeEventListener('submit', submitHandler, true);\r\n                window.removeEventListener('popstate', popStateHandler);\r\n\r\n                // Clean up HTMX listeners if they were added\r\n                if (window.htmx || document.querySelector('[hx-boost], [hx-get], [hx-post], [hx-put], [hx-patch], [hx-delete]')) {\r\n                    document.body.removeEventListener('htmx:confirm', htmxConfirmHandler);\r\n                    document.body.removeEventListener('htmx:beforeRequest', htmxBeforeRequestHandler);\r\n                    document.body.removeEventListener('htmx:afterRequest', htmxAfterRequestHandler);\r\n                    document.body.removeEventListener('htmx:responseError', htmxAfterRequestHandler);\r\n                    document.body.removeEventListener('htmx:sendError', htmxAfterRequestHandler);\r\n                    document.body.removeEventListener('htmx:halted', htmxHaltedHandler);\r\n                }\r\n\r\n                // Clean up Alpine/AJAX event listeners\r\n                el.removeEventListener('ajax:success', alpineSubmitSuccessHandler);\r\n                el.removeEventListener('ajax:error', alpineSubmitErrorHandler);\r\n                el.removeEventListener('submit:success', alpineSubmitSuccessHandler);\r\n                el.removeEventListener('submit:error', alpineSubmitErrorHandler);\r\n\r\n                // Restore original disabled state\r\n                if (originalDisabledState !== undefined) {\r\n                    submitButton.disabled = originalDisabledState;\r\n                }\r\n\r\n                // Restore original button text if it was changed\r\n                if (config.changeTextOnSubmit && submitButton.dataset.originalText) {\r\n                    submitButton.textContent = submitButton.dataset.originalText;\r\n                    delete submitButton.dataset.originalText;\r\n                }\r\n\r\n                // Clean up API\r\n                delete el._formSubmitLocker;\r\n            });\r\n        });\r\n    }\r\n\r\n    // Register the plugin when Alpine initializes\r\n    document.addEventListener(\"alpine:init\", () => {\r\n        window.Alpine.plugin(plugin_default);\r\n    });\r\n\r\n    // Auto-register if Alpine is already initialized\r\n    if (window.Alpine) {\r\n        window.Alpine.plugin(plugin_default);\r\n    }\r\n})();"],"names":["pluginName","plugin_default","Alpine","directive","el","modifiers","expression","cleanup","evaluate","func","wait","timeout","lastTime","tagName","console","error","config","debounceDelay","parseInt","validateOnMount","includes","disableOnSubmit","allowMultipleSubmits","focusOnError","changeTextOnSubmit","customValidator","submitButtons","Array","from","querySelectorAll","filter","btn","type","getAttribute","length","warn","submitButton","originalDisabledState","disabled","isFormValid","isValid","checkValidity","customResult","e","evaluateSubmit","nextTick","removeAttribute","setAttribute","inputHandler","event","target","args","context","clearTimeout","setTimeout","apply","changeHandler","resetHandler","isSubmitting","resetSubmitButton","dataset","originalText","textContent","submitHandler","hasAttribute","loadingText","preventDefault","stopPropagation","firstInvalid","querySelector","focus","scrollIntoView","behavior","block","announcement","document","createElement","style","position","left","width","height","overflow","appendChild","remove","htmxConfirmHandler","detail","elt","contains","originalIssueRequest","issueRequest","proceed","htmxBeforeRequestHandler","htmxAfterRequestHandler","htmxHaltedHandler","window","htmx","body","addEventListener","popStateHandler","now","Date","remaining","alpineSubmitSuccessHandler","alpineSubmitErrorHandler","_formSubmitLocker","validate","reset","unlock","removeEventListener","undefined","plugin"],"mappings":"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"}