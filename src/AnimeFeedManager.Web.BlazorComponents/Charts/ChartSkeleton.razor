<article id="chart-@ChartId"
         class="card bg-base-100 shadow-lg min-w-0"
         hx-get="@Endpoint"
         hx-trigger="@GetTrigger()"
         hx-swap="innerHTML"
         hx-ext="event-params"
         data-param-name="@ParamName">
    <div class="card-body">
        <header>
            <div class="skeleton h-6 w-full" aria-hidden="true"></div>
        </header>
        <div class="h-64 grid grid-cols-1 grid-rows-1 place-items-center" role="status" aria-label="Loading chart">
            <!-- Layer 1: The Skeleton (Background) -->
            <div class="skeleton h-full w-full col-start-1 row-start-1"></div>
            
            <!-- Layer 2: The Spinner (Foreground) -->
            <span class="loading loading-spinner loading-lg col-start-1 row-start-1"></span>
        </div>
    </div>
</article>

@code {
    [Parameter, EditorRequired] public required string ChartId { get; set; }
    [Parameter, EditorRequired] public required string Endpoint { get; set; }
    [Parameter] public string? UpdateTriggerEvent { get; set; }
    [Parameter] public string ParamName { get; set; } = "period";

    private string GetTrigger() => string.IsNullOrEmpty(UpdateTriggerEvent)
        ? "load"
        : $"load, {UpdateTriggerEvent} from:body";
}
